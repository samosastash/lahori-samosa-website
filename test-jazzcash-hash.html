<!DOCTYPE html>
<html>
<head>
    <title>JazzCash Hash Test</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
</head>
<body>
    <h1>JazzCash Hash Test</h1>
    <div id="result"></div>
    
    <script>
        // Test data (same as your app)
        const testData = {
            pp_Version: '1.1',
            pp_TxnType: 'MPAY',
            pp_MerchantID: 'MC407733',
            pp_Password: 'v58y3xx959',
            pp_TxnRefNo: 'TXN_1760716000000_test123',
            pp_Amount: '75000',
            pp_TxnCurrency: 'PKR',
            pp_TxnDateTime: '20251017T160000',
            pp_BillReference: 'LAHORITEST123',
            pp_Description: 'LAHORI SAMOSA INVOICE',
            pp_TxnExpiryDateTime: '20251017T163000',
            pp_ReturnURL: 'https://www.lahorisamosa.shop/api/payment-return',
            pp_MobileNumber: '923390078332',
            pp_CNIC: '',
            pp_ContactNumber: '923390078332',
            pp_Language: 'EN'
        };

        // Hash generation function (same as your app)
        function generateRequestHash(data) {
            const requestParams = [
                'pp_Amount', 'pp_BillReference', 'pp_CNIC', 'pp_ContactNumber', 'pp_Currency',
                'pp_Description', 'pp_Language', 'pp_MerchantID', 'pp_MobileNumber', 'pp_Password',
                'pp_ReturnURL', 'pp_TxnCurrency', 'pp_TxnDateTime', 'pp_TxnExpiryDateTime',
                'pp_TxnRefNo', 'pp_TxnType', 'pp_Version'
            ];
            
            const INTEGRITY_SALT = 'c78ust11gu';
            
            const sortedData = {};
            Object.keys(data)
                .filter(key => requestParams.includes(key) && key !== 'pp_SecureHash')
                .sort()
                .forEach(key => {
                    sortedData[key] = data[key] || '';
                });
            
            const concatenatedString = Object.values(sortedData).join('&');
            const hashString = `${INTEGRITY_SALT}&${concatenatedString}`;
            
            const hash = CryptoJS.HmacSHA256(hashString, INTEGRITY_SALT).toString(CryptoJS.enc.Hex).toUpperCase();
            
            return {
                sortedData,
                concatenatedString,
                hashString,
                hash
            };
        }

        // Test the hash generation
        const result = generateRequestHash(testData);
        
        document.getElementById('result').innerHTML = `
            <h2>Hash Generation Test</h2>
            <p><strong>Sorted Data:</strong></p>
            <pre>${JSON.stringify(result.sortedData, null, 2)}</pre>
            <p><strong>Concatenated String:</strong></p>
            <pre>${result.concatenatedString}</pre>
            <p><strong>Hash String:</strong></p>
            <pre>${result.hashString}</pre>
            <p><strong>Generated Hash:</strong></p>
            <pre>${result.hash}</pre>
        `;
        
        console.log('Hash test result:', result);
    </script>
</body>
</html>
